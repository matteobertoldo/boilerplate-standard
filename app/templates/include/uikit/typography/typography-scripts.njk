<script type="text/javascript">
/**
 * @function: Array.prototype.clean
 * @param: {string}
 * @return: [Array]
 * @description: clean empty value/s of an Array.
 */

Array.prototype.clean = function(deleteValue) {
    for (var i = 0; i < this.length; i++) {
        if (this[i] == deleteValue) {
            this.splice(i, 1);
            i--;
        }
    }

    return this;
};

/**
 * @function: getFontsInstalled
 * @param: {document.styleSheets}
 * @return: [object]
 * @description: Render the font Installed via @font-face or Google Fonts.
 * @author: mbertoldo@alpenite.com
 */

function getFontsInstalled(sheet) {
    var sheets = typeof sheet !== 'undefined' ? [sheet] : document.styleSheets,
        fontFace,
        gFonts;

    for (var i = 0, l = sheets.length; i < l; i++) {
        var sheet = sheets[i];

        if (!sheet.cssRules) {
            continue;
        }

        for (var j = 0, k = sheet.cssRules.length; j < k; j++) {
            var rule = sheet.cssRules[j];

            if (rule.toString() == "[object CSSFontFaceRule]") {
                var value = rules[j];
                var fontFamilyName = value.style.fontFamily || value.style.cssText.match(/font-family\s*:\s*([^;\}]*)\s*[;}]/i)[1];
                var fontStyle = value.style.fontStyle;
                var fontWeight = value.style.fontWeight;
                var list = document.createElement('li');
                var p = document.createElement('p');
                var span = document.createElement('span');
                var arrFamilyName = [fontFamilyName];

                list.setAttribute("style",
                    "font-family:" + fontFamilyName + ";" +
                    "font-style:" + fontStyle + ";" +
                    "font-weight:" + fontWeight + ";");
                p.appendChild(document.createTextNode('Aa'));
                span.appendChild(document.createTextNode(fontFamilyName));
                list.appendChild(p);
                list.appendChild(span);

                fontFace = document.getElementById('font-list').appendChild(list);
            } else if (rule.toString() == "[object CSSImportRule]") {
                if (rule.href != undefined) {
                    var href = rule.href;
                    var familiesToSplit = href.split('https://fonts.googleapis.com/css?family=').clean('');

                    if (familiesToSplit[0] != undefined) {
                        if (href.match(/fonts.googleapis/)) {
                            fontToSplit = familiesToSplit[0].split('|');

                            fontToSplit.map(function(item) {
                                var fontFamilyName = item.split(':')[0].replace(/\+/g,' ');
                                var list = document.createElement('li');
                                var p = document.createElement('p');
                                var span = document.createElement('span');

                                list.setAttribute("style",
                                    "font-family:" + '"' + fontFamilyName + '"' + ";" +
                                    "font-style:normal;" +
                                    "font-weight:normal;");
                                p.appendChild(document.createTextNode('Aa'));
                                span.appendChild(document.createTextNode(fontFamilyName));
                                list.appendChild(p);
                                list.appendChild(span);

                                gFonts = document.getElementById('font-list').appendChild(list);
                            });
                        }
                    }
                }
            }
        }
    }

    return fontFace, gFonts;
}

window.addEventListener('load', function() {
    getFontsInstalled();
});
</script>
